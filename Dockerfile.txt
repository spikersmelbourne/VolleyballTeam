# Dockerfile
FROM python:3.11-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

# Escreve credenciais a partir das variáveis de ambiente e inicia o servidor
# Render injeta automaticamente a variável $PORT
CMD ["/bin/sh", "-c", "printf \"%s\" \"$CREDENTIALS_JSON\" > credentials.json && printf \"%s\" \"$TOKEN_JSON\" > token.json && uvicorn main:app --host 0.0.0.0 --port ${PORT}"]